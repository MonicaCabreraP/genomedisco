#!/bin/sh
. /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/scripts/bashrc.allMethods
zcat -f  /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/HIC001.res40000.gz | sed 's/chr//g' | awk '{print "chr"$1"\t"$2"\tchr"$3"\t"$4"\t"$5}' | gzip > /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/data_to_hifive.py /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/nodes.partition /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_data
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz
${mypython} -c "import hifive; hic=hifive.HiC('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_project','w'); hic.load_data('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_data');hic.filter_fends(mininteractions=1); hic.save()"
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/software/hifive/bin/find_quasar_transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_project /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_transform -r 40000
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/plot_quasar_transform.py --transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_transform --out /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_transform
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_data /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_project
zcat -f  /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/HIC002.res40000.gz | sed 's/chr//g' | awk '{print "chr"$1"\t"$2"\tchr"$3"\t"$4"\t"$5}' | gzip > /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/data_to_hifive.py /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/nodes.partition /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_data
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz
${mypython} -c "import hifive; hic=hifive.HiC('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_project','w'); hic.load_data('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_data');hic.filter_fends(mininteractions=1); hic.save()"
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/software/hifive/bin/find_quasar_transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_project /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_transform -r 40000
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/plot_quasar_transform.py --transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_transform --out /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_transform
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_data /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_project

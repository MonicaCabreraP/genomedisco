#!/bin/sh
source /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/scripts/bashrc.allMethods
if [ ! /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz.tmp ];then rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz.tmp;fi
zcat -f  /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/HIC001.res40000.gz | awk '{print "chr"$1"	"$2"	chr"$3"	"$4"	"$5}' | sed 's/chrchr/chr/g' | awk -v chromo=chr21 '{if (($1==$3) && ($1==chromo)) print $0}' >> /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz.tmp
zcat -f  /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz.tmp | gzip > /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz.tmp
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/data_to_hifive.py /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/nodes.partition /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_data
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.fulldata.gz
${mypython} -c "import hifive; hic=hifive.HiC('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_project','w'); hic.load_data('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_data');hic.filter_fends(mininteractions=1); hic.save()"
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/software/hifive/bin/find_quasar_transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_project /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_transform -r 40000
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/plot_quasar_transform.py --transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_transform --out /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_transform
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_data /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC001.quasar_project
if [ ! /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz.tmp ];then rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz.tmp;fi
zcat -f  /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/HIC002.res40000.gz | awk '{print "chr"$1"	"$2"	chr"$3"	"$4"	"$5}' | sed 's/chrchr/chr/g' | awk -v chromo=chr21 '{if (($1==$3) && ($1==chromo)) print $0}' >> /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz.tmp
zcat -f  /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz.tmp | gzip > /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz.tmp
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/data_to_hifive.py /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/nodes.partition /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_data
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.fulldata.gz
${mypython} -c "import hifive; hic=hifive.HiC('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_project','w'); hic.load_data('/oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_data');hic.filter_fends(mininteractions=1); hic.save()"
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/software/hifive/bin/find_quasar_transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_project /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_transform -r 40000
${mypython} /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/reproducibility_analysis/plot_quasar_transform.py --transform /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_transform --out /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_transform
rm /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_data /oak/stanford/groups/akundaje/oursu/code/new_genomedisco/genomedisco/examples/output/data/forQuASAR/HIC002.quasar_project
